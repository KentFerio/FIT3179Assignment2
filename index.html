<!DOCTYPE html>
<html>
<head>
  <title>World Data Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      display: flex;
      flex-direction: column;
      max-width: 1200px;
      margin: 0 auto;
    }
    .filter-section {
      text-align: center;
      margin-bottom: 20px;
    }
    .main-content {
      display: flex;
      gap: 20px;
    }
    .visualization {
      flex: 2;
    }
    .analysis {
      flex: 1;
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
    }
    #vis {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>World Life Expectancy & GDP Analysis</h1>
    
    <div class="filter-section">
      <label for="yearSelect">Select Year: </label>
      <select id="yearSelect">
        <option value="2011">2011</option>
        <option value="2012">2012</option>
        <option value="2013">2013</option>
        <option value="2014">2014</option>
        <option value="2015">2015</option>
        <option value="2016">2016</option>
        <option value="2017">2017</option>
        <option value="2018">2018</option>
        <option value="2019">2019</option>
        <option value="2020" selected>2020</option>
      </select>
    </div>

    <div class="main-content">
      <div class="visualization">
        <div id="vis"></div>
      </div>
      
      <div class="analysis">
        <h2>Data Analysis</h2>
        <h3>Key Insights:</h3>
        <ul>
          <li><strong>Strong Positive Correlation:</strong> Higher GDP per capita generally correlates with longer life expectancy</li>
          <li><strong>Regional Patterns:</strong> Developed nations (North America, Europe, Australia) show both high GDP and long lifespans</li>
          <li><strong>Developing Nations:</strong> Many African and Asian countries cluster in the lower-left quadrant</li>
          <li><strong>Outliers:</strong> Some countries achieve good health outcomes despite lower economic development</li>
        </ul>
        
        <h3>Trends Over Time:</h3>
        <ul>
          <li>Life expectancy has generally increased globally from 2011-2020</li>
          <li>GDP growth patterns vary significantly by region</li>
          <li>The COVID-19 pandemic in 2020 shows notable impacts on life expectancy</li>
        </ul>
        
        <h3>Policy Implications:</h3>
        <ul>
          <li>Economic development alone doesn't guarantee health outcomes</li>
          <li>Healthcare infrastructure and public health policies are crucial</li>
          <li>Targeted interventions can improve life expectancy in lower-income nations</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // Your Vega-Lite JSON spec (without the text part)
    const spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v6.2.0.json",
      "title": "World Life Expectancy & GDP per Capita (2011-2020)",
      "vconcat": [
        {
          "title": "Life Expectancy by Country",
          "width": 600,
          "height": 400,
          "data": {
            "url": "https://raw.githubusercontent.com/KentFerio/FIT3179Assignment2/refs/heads/main/ne_110m.json",
            "format": {
              "type": "topojson",
              "feature": "ne_110m_admin_0_countries"
            }
          },
          "transform": [
            {
              "lookup": "properties.NAME",
              "from": {
                "data": {
                  "url": "https://raw.githubusercontent.com/KentFerio/FIT3179Assignment2/refs/heads/main/A2_countries_life_expectancy.csv",
                  "format": {"type": "csv"}
                },
                "key": "Country Name",
                "fields": ["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"]
              }
            },
            {
              "calculate": "datum[yearSelector]",
              "as": "life_expectancy"
            },
            {
              "filter": "datum.life_expectancy != null"
            }
          ],
          "projection": {
            "type": "naturalEarth1"
          },
          "mark": {
            "type": "geoshape",
            "stroke": "white",
            "strokeWidth": 0.5
          },
          "encoding": {
            "color": {
              "field": "life_expectancy",
              "type": "quantitative",
              "scale": {"scheme": "blues"},
              "title": "Life Expectancy"
            },
            "tooltip": [
              {"field": "properties.NAME", "type": "nominal", "title": "Country"},
              {"field": "life_expectancy", "type": "quantitative", "title": "Life Expectancy", "format": ".1f"}
            ]
          }
        },
        {
          "title": "GDP per Capita vs Life Expectancy",
          "width": 600,
          "height": 300,
          "data": {
            "url": "https://raw.githubusercontent.com/KentFerio/FIT3179Assignment2/refs/heads/main/A2_countries_gdp_per_capita.csv",
            "format": {"type": "csv"}
          },
          "transform": [
            {
              "fold": ["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"],
              "as": ["year", "gdp"]
            },
            {
              "filter": "datum.year == yearSelector"
            },
            {
              "lookup": "Country Name",
              "from": {
                "data": {
                  "url": "https://raw.githubusercontent.com/KentFerio/FIT3179Assignment2/refs/heads/main/A2_countries_life_expectancy.csv",
                  "format": {"type": "csv"}
                },
                "key": "Country Name",
                "fields": ["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"]
              }
            },
            {
              "calculate": "datum[yearSelector]",
              "as": "life_expectancy"
            },
            {
              "filter": "datum.gdp != null && datum.life_expectancy != null"
            }
          ],
          "mark": {
            "type": "circle",
            "opacity": 0.7
          },
          "encoding": {
            "x": {
              "field": "gdp",
              "type": "quantitative",
              "title": "GDP per Capita (USD)",
              "scale": {"type": "log"}
            },
            "y": {
              "field": "life_expectancy",
              "type": "quantitative",
              "title": "Life Expectancy (years)"
            },
            "size": {
              "field": "gdp",
              "type": "quantitative",
              "legend": null
            },
            "color": {
              "field": "Country Name",
              "type": "nominal",
              "legend": null
            },
            "tooltip": [
              {"field": "Country Name", "type": "nominal", "title": "Country"},
              {"field": "gdp", "type": "quantitative", "title": "GDP per Capita", "format": "$,.0f"},
              {"field": "life_expectancy", "type": "quantitative", "title": "Life Expectancy", "format": ".1f"}
            ]
          }
        }
      ],
      "params": [
        {
          "name": "yearSelector",
          "value": "2020",
          "bind": {
            "input": "select",
            "options": ["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"],
            "labels": ["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"],
            "name": "Select Year: "
          }
        }
      ],
      "config": {
        "view": {"stroke": "transparent"},
        "background": "white"
      }
    };

    // Embed the visualization
    vegaEmbed('#vis', spec);
  </script>
</body>
</html>
